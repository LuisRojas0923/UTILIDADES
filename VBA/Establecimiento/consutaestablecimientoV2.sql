select  
	distinct E.codigo as "Codigo", 
	E.fecha as "Fecha de Registro", 
	date_trunc('second', E.hora) as "Hora de Registro", E.nroCedula as "Numero de Cedula", E.nombre as "Nombre", E.fechaNacimiento as "Fecha de Nacimiento", extract('year' from (select age(CAST(E.fechaNacimiento AS timestamp)))) as "Edad", E.primeraFechaIngreso as "Primera Fecha Ingreso ", E.cargo as "Cargo", E.empresa as "Empresa", C.estado as "Estado", E.centroCosto as "Centro de Costo", E.cuenta as "Cuenta", E.tipo as "Tipo", E.nomina as "Nomina", E.regional as "Regional", E.area as "Area", E.jefe as "Jefe", E.gerencia as "Gerencia", E.ciudadContratacion as "Ciudad de Contratacion", E.gradoAlcanzado as "Grado Alcanzado", E.tituloObtenido as "Titulo Obtenido", E.tarjetaProfesional as "Tarjeta Profesional", E.rh as "RH", E.cuentaNomina as "Cuenta de Nomina", E.banco as "Banco", E.riesgoArl as "Riesgo ARL", E.sexo as "Sexo", E.nroHijos as "Numero de Hijos", E.correoCorporativo as "Correo Corporativo", E.correoPersonal as "Correo Personal", E.arl as "ARL", E.eps as "EPS", E.afp as "AFP", E.ccf as "CCF", E.afc as "AFC", CASE WHEN E.viaticante = 't' THEN 'SI' else 'NO' end as "Viaticante", E.baseViaticos as "Base Viaticos", E.tallaCamisa as "Talla Camisa", E.tallaPantalon as "Talla Pantalon", E.tallaBotas as "Talla Botas", E.examenMedico as "Examen de Ingreso", E.fechaVencimientoExamenMedico as "Fecha Vencimiento Examen de Ingreso", E.certificadoAlturas as "Certificado Trabajo en Alturas", E.fechaVencimientoAlturas as "Fecha Vencimiento Trabajo en Alturas", E.certificadoPrimerosAuxilios as "Certificado Primeros Auxilios", E.fechaVencimientoPrimerosAuxilios as "Fecha Vencimiento Primeros Auxilios", C.tipo as "C.tipo", C.fechaInicio as "C.fechaInicio", C.fechaInicioEtapaProductiva as "C.fechaInicioEtapaProductiva", C.fechaVencimiento as "C.fechaVencimiento", C.fechaRetiro as "C.fechaRetiro", C.duracionMeses as "C.duracionMeses", C.estado as "C.estado", C.causaTerminacion as "C.causaTerminacion", CASE WHEN C.pazYSalvo = 't' THEN 'SI' else 'NO' end as "C.pazYSalvo", B.fechaInicio as "B.fechaInicio", B.fechaFin as "B.fechaFin", B.salario as "B.salario", B.moneda as "B.moneda", B.valorMaximoBono as "B.valorMaximoBono", B.capacidadEndeudamiento as "B.capacidadEndeudamiento", CASE WHEN B.autorizacionHorasExtras = 't' THEN 'SI' else 'NO' end as "B.autorizacionHorasExtras", B.auxilioAlimentacionQuincenal as "B.auxilioAlimentacionQuincenal", B.auxilioAlimentacionMensual as "B.auxilioAlimentacionMensual", B.baseRodamiento as "B.baseRodamiento", CASE WHEN B.autorizacionRodamiento = 't' THEN 'SI' else 'NO' end as "B.autorizacionRodamiento", B.rodamiento as "B.rodamiento", B.auxilioVivienda as "B.auxilioVivienda", B.periodicidadPago as "B.periodicidadPago", B.estado as "B.estado"  from establecimiento E, contrato C, beneficio B  where C.establecimiento = E.nroCedula and B.contrato = C.numeroContrato and (lower(E.nroCedula::text) like '%%') order by "Fecha de Registro" asc